---
title: "Peer Assigment 1"
author: "Sean Treadway"
date: "June 14, 2015"
output: html_document
---

Report for Peer Assignment #1 in Reproduceable Research

The data to be analysed and reported on is 2 month of pedometer data from an anonymouns individual.  The data was gathered over 2 months, and the actual "step" are binned in to 5-minute interval.  There are a total of 17568 5-minute interval records.  Each record consisted of a "step", "data", and "interval" entry.

The data provided as part of the assignment.

Here the data is read in to R.
```{r, echo=TRUE}
#Set number of record/lines.  Given in instructions, checked with 'wc' at command line
records=17568
#Set the colume classes
classes<-c("numeric","Date","numeric")
#Set column names.  Comes from header
cnames=c("steps","date","interval")
#Read in data
alldata<-read.delim("../activity.csv",header=TRUE,sep=",", nrows=records,colClasses=classes,strip.white=TRUE)
```

The first part of the assigment was to determine the mean, and median daily steps, and to plot a histogram of daily steps.
NAs in the step entries were ignored for this part of the analysis.
```{r, echo=TRUE}
#Create a logical vector for selecting records with out step NAs
goodrows<-!is.na(alldata$steps)
#Create total steps per day vector
daily<- as.vector(tapply(alldata[goodrows,]$steps,alldata[goodrows,]$date,sum))
#Determine the mean and median daily steps, ignoring NAs
dailymean<-mean(daily)
dailymedian<-median(daily)
```
The mean total steps was 10766.189, and the median 10765.

Just below is the histogram for total daily steps.
```{r, echo=TRUE}
#Create histogram showing daily step count frequency
hist(daily,main="Histogram of Daily Step Count",xlab="Steps/Day",ylab="Number of Days")
```

```{r, echo=TRUE}
#Determine the mean for each interval.  This will be used to fill in the step NAs.  
#This totally ignores day/week/month differences that might exist, and any trends in activity. 
#Ignoring these simplifies the analysis for the sake of the exercise.
intmeans24<-tapply(alldata$steps,alldata$interval,mean,na.rm=TRUE)
#Determine what interval sees the highest mean number of steps
which.max(intmeans24)
#Plot the mean number of steps on an interval basis
plot(intmeans24,type='l')
```


```{r, echo=TRUE}
sub<-function(record){
        
        if(is.na(record[1])) {
                record[1]<-intmeans24[as.character(record[2])]
        }
        return(record[1])
}
moddata<-alldata
moddata$steps<-apply(subset(alldata, select=c(steps,interval)),1,sub)

moddaily<- as.vector(tapply(moddata$steps,moddata$date,sum))
hist(moddaily,main="Histogram of Daily Step Count For Modified Data",xlab="Steps/Day",ylab="Number of Days")
moddailymean<-mean(moddaily)
moddailymedian<-median(moddaily)
```